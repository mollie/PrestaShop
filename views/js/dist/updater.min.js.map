{"version":3,"sources":["webpack://MollieModule.[name]/./src/back/updater/index.ts","webpack://MollieModule.[name]/./src/shared/axios.ts"],"names":["showError","message","Promise","all","swal","default","icon","title","get","document","text","xss","then","handleClick","config","translations","steps","action","defaultError","unableToConnect","unableToUnzip","step","axios","endpoint","data","console","error","updated","button","onclick","create","transformResponse","res","JSON","parse","replace","headers"],"mappings":"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","file":"updater.min.js","sourcesContent":["/**\n * Mollie       https://www.mollie.nl\n *\n * @author      Mollie B.V. <info@mollie.nl>\n * @copyright   Mollie B.V.\n * @link        https://github.com/mollie/PrestaShop\n * @license     https://github.com/mollie/PrestaShop/blob/master/LICENSE.md\n * @codingStandardsIgnoreStart\n */\nimport xss from 'xss';\nimport { get } from 'lodash';\n\nimport axios from '@shared/axios';\nimport { ITranslations } from '@shared/globals';\n\nconst showError = async (message: string): Promise<void> => {\n  const [\n    { default: swal },\n  ] = await Promise.all([\n      import(/* webpackPrefetch: true, webpackChunkName: \"sweetalert\" */ 'sweetalert'),\n  ]);\n  swal({\n    icon: 'error',\n    title: get(document, 'documentElement.lang', 'en') === 'nl' ? 'Fout' : 'Error',\n    text: xss(message),\n  }).then();\n};\n\nconst handleClick = async (config: any, translations: ITranslations): Promise<void> => {\n  const steps = [\n    {\n      action: 'downloadUpdate',\n      defaultError: translations.unableToConnect,\n    },\n    {\n      action: 'downloadUpdate',\n      defaultError: translations.unableToUnzip,\n    },\n    {\n      action: 'downloadUpdate',\n      defaultError: translations.unableToConnect,\n    },\n  ];\n\n  for (let step of steps) {\n    try {\n      const { data } = await axios.get(`${config.endpoint}&action=${step.action}`);\n      if (!get(data, 'success')) {\n        showError(get(data, 'message', step.defaultError)).then();\n      }\n    } catch (e) {\n      console.error(e);\n      showError(step.defaultError).then();\n    }\n  }\n\n  import(/* webpackPrefetch: true, webpackChunkName: \"sweetalert\" */ 'sweetalert').then(({ default: swal }) => {\n    swal({\n      icon: 'success',\n      text: translations.updated\n    }).then();\n  });\n};\n\nexport default (button: HTMLElement, config: any, translations: ITranslations) => {\n  button.onclick = () => handleClick(config, translations);\n};\n\n","/**\n * Mollie       https://www.mollie.nl\n *\n * @author      Mollie B.V. <info@mollie.nl>\n * @copyright   Mollie B.V.\n * @link        https://github.com/mollie/PrestaShop\n * @license     https://github.com/mollie/PrestaShop/blob/master/LICENSE.md\n * @codingStandardsIgnoreStart\n */\nimport axios from 'axios';\n\nexport default axios.create({\n  transformResponse: [res => JSON.parse(res.replace(/^[^{[]*/mg, '').replace(/([^}\\]]*)$/mg, ''))],\n  headers: {\n    'X-Requested-With': 'XMLHttpRequest',\n    'Content-Type': 'application/json',\n    'Accept': 'application/json',\n  },\n});\n\n"],"sourceRoot":""}